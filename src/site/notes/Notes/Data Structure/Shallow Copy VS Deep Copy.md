---
{"dg-publish":true,"permalink":"/notes/data-structure/shallow-copy-vs-deep-copy/"}
---

### النسخة السطحية (Shallow Copy) والنسخة العميقة (Deep Copy)

عند نسخ هياكل البيانات (مثل القوائم أو المصفوفات) في لغات البرمجة، قد تواجه مفهوم النسخ السطحي (Shallow Copy) والنسخ العميق (Deep Copy). كل منهما يعامل البيانات بطريقة مختلفة، ويمكن أن يؤثر ذلك على كيفية التفاعل مع العناصر المكررة في البيانات.

---

### 1. **النسخة السطحية (Shallow Copy)**

النسخة السطحية هي عملية نسخ الكائن الأصلي (مثل القائمة) ولكن دون نسخ العناصر الفرعية أو الكائنات التي يحتويها الكائن الأصلي. بعبارة أخرى، يتم إنشاء كائن جديد ولكنه يشير إلى نفس البيانات في الذاكرة التي كانت تشير إليها الكائنات الأصلية.

#### كيفية العمل:
- يتم إنشاء نسخة جديدة من الكائن، ولكن عناصر هذه النسخة لا تُنسخ فعلياً، بل تكون إشارات إلى نفس العناصر الموجودة في الكائن الأصلي.
- إذا تم تعديل أحد العناصر القابلة للتغيير (مثل القوائم أو القواميس) في النسخة السطحية أو الأصلية، فإن التعديل سينعكس في الكائن الآخر.

#### مثال في Python:
```python
import copy

original_list = [1, 2, [3, 4]]
shallow_copy = copy.copy(original_list)

shallow_copy[2][0] = 100

print(original_list)  # [1, 2, [100, 4]]
print(shallow_copy)   # [1, 2, [100, 4]]
```

#### ملاحظات:
- كما ترى، تعديل القائمة الفرعية في النسخة السطحية (`shallow_copy`) ينعكس أيضًا على القائمة الأصلية (`original_list`)، لأن القائمة الفرعية تم نسخها كمرجع وليس كقيمة.

---

### 2. **النسخة العميقة (Deep Copy)**

النسخة العميقة هي عملية نسخ الكائن الأصلي وجميع العناصر أو الكائنات الفرعية بداخله. يتم إنشاء كائن جديد يتم نسخه بالكامل من الكائن الأصلي، بما في ذلك جميع الكائنات الفرعية. وبالتالي، لن يكون هناك أي ترابط بين الكائنات الفرعية في النسخة الجديدة والكائنات الفرعية في النسخة الأصلية.

#### كيفية العمل:
- يتم إنشاء نسخة جديدة من الكائن وجميع الكائنات الفرعية المرتبطة به.
- إذا تم تعديل أي عنصر قابل للتغيير في النسخة العميقة، فإن هذا التعديل لا يؤثر على الكائن الأصلي أو العكس.

#### مثال في Python:
```python
import copy

original_list = [1, 2, [3, 4]]
deep_copy = copy.deepcopy(original_list)

deep_copy[2][0] = 100

print(original_list)  # [1, 2, [3, 4]]
print(deep_copy)      # [1, 2, [100, 4]]
```

#### ملاحظات:
- هنا، تعديل القائمة الفرعية في النسخة العميقة (`deep_copy`) لا يؤثر على القائمة الأصلية (`original_list`)، لأن الكائنات الفرعية تم نسخها بالكامل.

---

### مقارنة بين النسخة السطحية والعميقة:

|                | **النسخة السطحية (Shallow Copy)** | **النسخة العميقة (Deep Copy)** |
|----------------|-----------------------------------|---------------------------------|
| **النسخ**      | ينسخ الكائن الرئيسي فقط، والكائنات الفرعية تظل كما هي (مشار إليها). | ينسخ الكائن الرئيسي وجميع الكائنات الفرعية. |
| **التأثير على الكائن الأصلي** | تعديل الكائنات الفرعية في النسخة يؤثر على الأصلية والعكس صحيح. | تعديل الكائنات في النسخة لا يؤثر على الأصلية. |
| **الأداء**     | أسرع في النسخ (لأن العناصر الفرعية لا تُنسخ). | أبطأ في النسخ (لأن كل الكائنات تُنسخ بالكامل). |

---

### متى تستخدم كل منها:
- **النسخة السطحية**: مناسبة عندما لا تحتاج إلى تعديل العناصر الفرعية أو عند التعامل مع كائنات غير قابلة للتغيير مثل الأعداد والنصوص.
- **النسخة العميقة**: مناسبة عندما تحتاج إلى نسخ البيانات بشكل مستقل تمامًا وتجنب التأثير على النسخة الأصلية بأي شكل.

---

**خلاصة:**  
- النسخة السطحية **(Shallow Copy)** تنسخ الهيكل الأساسي فقط ولكنها لا تنسخ العناصر الفرعية، وبالتالي أي تعديل في العناصر الفرعية يؤثر على النسخة الأصلية.
- النسخة العميقة **(Deep Copy)** تنسخ الكائن والعناصر الفرعية بشكل كامل ومستقل، مما يضمن عدم تأثير النسخ على بعضها البعض.